{% extends "landing.html" %}
{% load static %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div class="container mt-5 content-space-3 content-space-t-lg-4 content-space-b-lg-3">
    <div class=" flex-grow-1 mx-auto" style="max-width: 28rem;">
        <div class="card-header pt-2 pb-1 text-center bg-primary rounded-top">
            <h4 class="text-white text-center pb-0 fw-bold fs-3">Crear cuenta de empresa</h4>
        </div>

        <div class="text-center mb-3 mb-md-4">
            <p class="text-muted mb-5 fs-5">Ingresa los datos de tu empresa.</p>
        </div>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-4">
                <label class="form-label" for="nombre">Nombre de la empresa</label>
                <input class="form-control" id="nombre" type="text" required="" placeholder="Ingrese el nombre de la empresa">
            </div>

            <div class="mb-4">
                <label for="sectorEmpresa" class="form-label">Sector de la empresa</label>
                <select class="form-select" id="sectorEmpresa" required
                    style="max-width: 100%; overflow: hidden; text-overflow: ellipsis; max-height: 200px;">
                    <option selected disabled>Seleccione un sector...</option>
                    <option value="tecnologia" title="TecnologÃ­a e InformÃ¡tica">ğŸ–¥ï¸ TecnologÃ­a</option>
                    <option value="salud" title="Salud y FarmacÃ©utico">ğŸ¥ Salud</option>
                    <option value="financiero" title="Servicios Financieros">ğŸ’² Financiero</option>
                    <option value="educacion" title="EducaciÃ³n y FormaciÃ³n">ğŸ“š EducaciÃ³n</option>
                    <option value="manufactura" title="Manufactura y ProducciÃ³n">ğŸ­ Manufactura</option>
                    <option value="comercio" title="Comercio Minorista">ğŸ›’ Comercio</option>
                    <option value="logistica" title="LogÃ­stica y Transporte">ğŸšš LogÃ­stica</option>
                    <option value="construccion" title="ConstrucciÃ³n e Inmobiliario">ğŸ—ï¸ ConstrucciÃ³n</option>
                    <option value="energia" title="EnergÃ­a y Utilities">âš¡ EnergÃ­a</option>
                    <option value="turismo" title="Turismo y HostelerÃ­a">ğŸ¨ Turismo</option>
                    <option value="agricultura" title="Agricultura y Agroindustria">ğŸŒ¾ Agricultura</option>
                    <option value="medios" title="Medios y Entretenimiento">ğŸ¬ Medios</option>
                    <option value="consultoria" title="ConsultorÃ­a y Servicios Profesionales">ğŸ“Š ConsultorÃ­a</option>
                    <option value="textil" title="Textil y Moda">ğŸ‘— Textil</option>
                    <option value="automotriz" title="Automotriz">ğŸš— Automotriz</option>
                    <option value="bienes" title="Bienes de Consumo">ğŸ›ï¸ Bienes</option>
                </select>
            </div>

            <div class="mb-4">
                <label for="country" class="form-label">PaÃ­s</label>
                <select id="country" class="form-select">
                    <option value="">Seleccione un paÃ­s</option>
                </select>
            </div>

            <div class="mb-4">
                <label for="state" class="form-label">RegiÃ³n/Estado</label>
                <select id="state" class="form-select" disabled>
                    <option value="">Seleccione una regiÃ³n</option>
                </select>
            </div>

            <div class="mb-4">
                <label for="city" class="form-label">Ciudad</label>
                <select id="city" class="form-select" disabled>
                    <option value="">Seleccione una ciudad</option>
                </select>
            </div>

            <div class="mb-4">
                <label class="form-label" for="direccion">DirecciÃ³n</label>
                <input class="form-control" id="direccion" type="text" required="" placeholder="DirecciÃ³n de la empresa">
            </div>

            <div class="mb-4">
                <label class="form-label" for="telefono">TelÃ©fono</label>
                <input class="form-control" id="telefono" type="text" required="" placeholder="TelÃ©fono de la empresa">
            </div>

            <div class="mb-4">
                <label class="form-label" for="ruc">RUC</label>
                <input class="form-control" id="ruc" type="text" placeholder="Ingresa el nÃºmero de RUC">
            </div>

            <div class="mb-4">
                <label for="foto" class="form-label">Foto</label>
                <input class="form-control border-primary shadow-sm" type="file" id="foto" name="foto" accept="image/*">
                <div class="form-text">Sube una imagen en formato JPG, PNG o similar.</div>
            </div>

            <div class="mb-4">
                <label for="example-textarea" class="form-label">DescripciÃ³n</label>
                <textarea class="form-control" id="example-textarea" rows="5" placeholder="Ingresa una descripciÃ³n de la empresa."></textarea>
            </div>

            <div class="mb-3 mb-0 text-center">
                <button class="btn btn-primary" type="submit">Crear cuenta</button>
            </div>

        </form>
    </div>
</div>

<script>
    let data = [];

    fetch("{% static 'js/paises.json' %}")
        .then(response => response.json())
        .then(json => {
            data = json;
            populateCountries();
        });

    const countrySelect = document.getElementById('country');
    const stateSelect = document.getElementById('state');
    const citySelect = document.getElementById('city');

    function populateCountries() {
        data.forEach(country => {
            const option = document.createElement('option');
            option.value = country.iso2;
            option.textContent = country.name;
            countrySelect.appendChild(option);
        });
        countrySelect.disabled = false;
    }

    countrySelect.addEventListener('change', function () {
        const selectedCountry = data.find(country => country.iso2 === this.value);
        stateSelect.innerHTML = '<option value="">Seleccione una regiÃ³n</option>';
        citySelect.innerHTML = '<option value="">Seleccione una ciudad</option>';
        citySelect.disabled = true;

        if (selectedCountry && selectedCountry.states.length > 0) {
            selectedCountry.states.forEach(state => {
                const option = document.createElement('option');
                option.value = state.state_code;
                option.textContent = state.name;
                stateSelect.appendChild(option);
            });
            stateSelect.disabled = false;
        } else {
            stateSelect.disabled = true;
        }
    });

    stateSelect.addEventListener('change', function () {
        const selectedCountry = data.find(country => country.iso2 === countrySelect.value);
        const selectedState = selectedCountry.states.find(state => state.state_code === this.value);
        citySelect.innerHTML = '<option value="">Seleccione una ciudad</option>';

        if (selectedState && selectedState.cities.length > 0) {
            selectedState.cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city.name;
                option.textContent = city.name;
                citySelect.appendChild(option);
            });
            citySelect.disabled = false;
        } else {
            citySelect.disabled = true;
        }
    });
</script>
{% endblock content %}